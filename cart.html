<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Shopping Cart - XS Platform</title>
    <link rel="stylesheet" href="header-footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* CART PAGE SPECIFIC STYLES */
        .cart-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 70vh;
        }

        /* Cart Header */
        .cart-header {
            margin-bottom: 40px;
            text-align: center;
            padding: 20px 0;
        }

        .cart-header h1 {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .cart-header p {
            color: var(--secondary-text);
            margin: 0;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .cart-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 600px;
            margin: 30px auto;
            position: relative;
        }

        .cart-progress:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--light-bg);
            z-index: 1;
        }

        .progress-step {
            background: white;
            border: 2px solid var(--light-bg);
            color: var(--secondary-text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .progress-step.active {
            background: var(--primary-blue);
            border-color: var(--primary-blue);
            color: white;
        }

        .progress-step.completed {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
        }

        .step-label {
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 0.9rem;
            color: var(--secondary-text);
        }

        .progress-step.active .step-label {
            color: var(--primary-blue);
            font-weight: 600;
        }

        .progress-step.completed .step-label {
            color: #4CAF50;
        }

        /* Cart Content */
        .cart-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 40px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 992px) {
            .cart-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        /* Cart Items Section */
        .cart-items {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .cart-items-header {
            padding: 20px;
            border-bottom: 1px solid var(--light-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .cart-items-header h2 {
            color: var(--primary-text);
            margin: 0;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-items-count {
            background: var(--primary-blue);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .cart-item {
            display: grid;
            grid-template-columns: 120px 1fr auto;
            gap: 20px;
            padding: 25px;
            border-bottom: 1px solid var(--light-bg);
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .cart-item:hover {
            background: #fafafa;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 120px;
            height: 120px;
            border-radius: 12px;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .cart-item:hover .cart-item-image img {
            transform: scale(1.05);
        }

        .cart-item-image .placeholder-icon {
            font-size: 48px;
            color: var(--accent-blue);
            opacity: 0.7;
        }

        .cart-item-details {
            flex: 1;
        }

        .item-title {
            font-weight: 700;
            color: var(--primary-text);
            margin-bottom: 8px;
            font-size: 1.2rem;
            line-height: 1.4;
        }

        .item-title a {
            color: inherit;
            text-decoration: none;
            transition: color 0.2s;
        }

        .item-title a:hover {
            color: var(--primary-blue);
        }

        .item-type {
            display: inline-block;
            padding: 4px 12px;
            background: var(--light-bg);
            color: var(--accent-blue);
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .item-type.product {
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            color: #1565C0;
        }

        .item-type.service {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            color: #2E7D32;
        }

        .item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            color: var(--secondary-text);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .item-price {
            font-weight: 700;
            color: var(--primary-blue);
            font-size: 1.3rem;
            margin-top: 10px;
        }

        .item-actions {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .action-btn {
            background: none;
            border: none;
            color: var(--secondary-text);
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: var(--light-bg);
            color: var(--primary-blue);
            text-decoration: none;
        }

        .action-btn.save-later:hover {
            color: #e91e63;
            background: #fce4ec;
        }

        .action-btn.remove:hover {
            color: #d32f2f;
            background: #ffebee;
        }

        /* Quantity Controls */
        .quantity-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            border: 2px solid var(--light-bg);
            border-radius: 12px;
            padding: 8px;
            width: fit-content;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .quantity-btn {
            background: white;
            border: 2px solid var(--accent-blue);
            color: var(--accent-blue);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover:not(:disabled) {
            background: var(--accent-blue);
            color: white;
            transform: translateY(-1px);
        }

        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: var(--border-color);
            color: var(--border-color);
        }

        .quantity-input {
            width: 60px;
            text-align: center;
            border: none;
            background: transparent;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-text);
        }

        .quantity-input:focus {
            outline: none;
        }

        .stock-status {
            font-size: 0.85rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }

        .stock-status.in-stock {
            color: #2e7d32;
            background: #e8f5e9;
        }

        .stock-status.low-stock {
            color: #f57c00;
            background: #fff3e0;
        }

        .item-total-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }

        .item-total {
            font-weight: 800;
            color: var(--primary-text);
            font-size: 1.4rem;
            text-align: right;
            min-width: 120px;
        }

        .item-subtotal {
            font-size: 0.9rem;
            color: var(--secondary-text);
        }

        /* Cart Summary */
        .cart-summary {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            padding: 30px;
            height: fit-content;
            position: sticky;
            top: 20px;
            border: 1px solid var(--border-color);
        }

        .summary-title {
            color: var(--primary-text);
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--light-bg);
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            color: var(--secondary-text);
            font-size: 1rem;
            padding: 8px 0;
        }

        .summary-row.highlight {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 12px 15px;
            border-radius: 8px;
            margin: 20px -15px;
        }

        .summary-row.total {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-blue);
            margin-top: 25px;
            padding-top: 25px;
            border-top: 3px solid var(--light-bg);
        }

        .summary-note {
            color: var(--secondary-text);
            font-size: 0.9rem;
            margin: 25px 0;
            padding: 20px;
            background: linear-gradient(135deg, #fff9e6 0%, #ffecb3 100%);
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .summary-note i {
            color: #ff9800;
            margin-top: 2px;
        }

        .summary-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .checkout-btn {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .checkout-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.4);
        }

        .checkout-btn:disabled {
            background: linear-gradient(135deg, #cccccc 0%, #aaaaaa 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .continue-shopping {
            background: white;
            color: var(--primary-text);
            border: 2px solid var(--accent-blue);
            padding: 15px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .continue-shopping:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-color: var(--primary-blue);
        }

        /* Coupon Section */
        .coupon-section {
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border: 1px dashed var(--border-color);
        }

        .coupon-title {
            margin-bottom: 15px;
            color: var(--primary-text);
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .coupon-input-group {
            display: flex;
            gap: 10px;
        }

        .coupon-input {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid var(--light-bg);
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }

        .coupon-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .apply-coupon-btn {
            background: var(--primary-text);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s ease;
        }

        .apply-coupon-btn:hover {
            background: #333;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* Empty Cart State */
        .empty-cart {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-top: 40px;
            animation: fadeIn 0.5s ease;
        }

        .empty-cart-icon {
            font-size: 120px;
            color: var(--light-bg);
            margin-bottom: 30px;
            opacity: 0.7;
        }

        .empty-cart h2 {
            color: var(--primary-text);
            margin-bottom: 15px;
            font-size: 2rem;
        }

        .empty-cart p {
            color: var(--secondary-text);
            margin-bottom: 40px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .empty-cart-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .shop-products-btn, .shop-services-btn {
            padding: 16px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .shop-products-btn {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .shop-services-btn {
            background: white;
            color: var(--primary-text);
            border: 2px solid var(--accent-blue);
        }

        .shop-products-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.4);
        }

        .shop-services-btn:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-color: var(--primary-blue);
            transform: translateY(-2px);
        }

        /* Loading State */
        .cart-loading {
            text-align: center;
            padding: 60px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-top: 40px;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid var(--light-bg);
            border-radius: 50%;
            border-top-color: var(--primary-blue);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .cart-loading p {
            color: var(--secondary-text);
            font-size: 1.1rem;
        }

        /* Error State */
        .cart-error {
            text-align: center;
            padding: 60px;
            background: #ffebee;
            border-radius: 16px;
            border: 2px solid #f44336;
            margin-top: 40px;
        }

        .cart-error i {
            font-size: 60px;
            color: #f44336;
            margin-bottom: 20px;
        }

        .cart-error h3 {
            color: #d32f2f;
            margin-bottom: 15px;
        }

        .retry-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }

        .retry-btn:hover {
            background: #d32f2f;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .cart-container {
                padding: 15px;
            }
            
            .cart-header h1 {
                font-size: 2rem;
            }
            
            .progress-step {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
            
            .step-label {
                font-size: 0.8rem;
                top: 40px;
            }
            
            .cart-item {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
                gap: 15px;
                padding: 20px;
            }
            
            .cart-item-image {
                width: 100%;
                height: 200px;
                justify-self: center;
            }
            
            .item-price-total {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
                padding-top: 15px;
                border-top: 1px solid var(--light-bg);
            }
            
            .item-total {
                text-align: left;
                min-width: auto;
            }
            
            .quantity-section {
                width: 100%;
                flex-direction: row;
                justify-content: space-between;
            }
            
            .empty-cart-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .shop-products-btn, .shop-services-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .coupon-input-group {
                flex-direction: column;
            }
            
            .apply-coupon-btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .cart-header h1 {
                font-size: 1.8rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .progress-step {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .step-label {
                font-size: 0.7rem;
                top: 35px;
            }
            
            .item-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-btn {
                justify-content: center;
            }
            
            .cart-summary {
                padding: 20px;
            }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            color: var(--primary-text);
            padding: 20px 25px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 10000;
            max-width: 400px;
            animation: slideIn 0.3s ease;
            border-left: 5px solid var(--primary-blue);
        }

        .toast.success {
            border-left-color: #4CAF50;
        }

        .toast.error {
            border-left-color: #f44336;
        }

        .toast i {
            font-size: 24px;
        }

        .toast.success i {
            color: #4CAF50;
        }

        .toast.error i {
            color: #f44336;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Cart Suggestions */
        .cart-suggestions {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .suggestions-title {
            color: var(--primary-text);
            margin-bottom: 25px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .suggestion-item {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .suggestion-item:hover {
            transform: translateY(-5px);
        }

        .suggestion-icon {
            font-size: 40px;
            color: var(--accent-blue);
            margin-bottom: 15px;
        }

        .suggestion-item h4 {
            color: var(--primary-text);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .suggestion-item p {
            color: var(--secondary-text);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .add-suggestion-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .add-suggestion-btn:hover {
            background: var(--accent-blue);
        }

        /* Security Badges */
        .security-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            color: var(--secondary-text);
            font-size: 0.9rem;
        }

        .security-badge i {
            color: var(--accent-blue);
        }
    </style>
</head>
<body>
<!-- Cart Specific Header -->
<header class="main-header">
    <div class="header-top-row">
        <div class="logo-and-nav">
            <div class="logo">XS</div>
            <div class="slogan">Premium Electronics Store</div>
            <nav class="main-nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="products.html" class="nav-link">Products</a>
                <a href="services.html" class="nav-link">Services</a>
                <a href="deals.html" class="nav-link">Deals</a>
                <a href="support.html" class="nav-link">Support</a>
                <a href="cart.html" class="nav-link active">Cart <span class="nav-cart-count">0</span></a>
            </nav>
        </div>

        <div class="search-and-actions">
            <div class="search-bar-top">
                <i class="fas fa-search"></i>
                <input type="text" id="global-search" placeholder="Search products..." class="search-input">
            </div>

            <!-- Desktop Auth State -->
            <div class="auth-state">
                <!-- Logged Out State -->
                <div class="logged-out-state" id="logged-out-state">
                    <a href="login.html" class="auth-link login-btn">
                        <i class="fas fa-sign-in-alt"></i> Log in
                    </a>
                </div>
                
                <!-- Logged In State -->
                <div class="logged-in-state" id="logged-in-state" style="display: none;">
                    <div class="user-profile">
                        <button class="user-menu-btn" id="user-menu-btn" aria-label="Open account menu">
                            <i class="fas fa-user-circle"></i>
                        </button>
                        <div class="user-dropdown" id="user-dropdown">
                            <a href="user-dashboard.html" class="dropdown-item">
                                <i class="fas fa-tachometer-alt"></i> Dashboard
                            </a>
                            <a href="profile.html" class="dropdown-item">
                                <i class="fas fa-user"></i> My Profile
                            </a>
                            <a href="orders.html" class="dropdown-item">
                                <i class="fas fa-box"></i> My Orders
                            </a>
                            <a href="wishlist.html" class="dropdown-item">
                                <i class="fas fa-heart"></i> Wishlist
                            </a>
                            <div class="dropdown-divider"></div>
                            <button class="dropdown-item logout-btn" id="logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="btn-wishlist" id="wishlist-btn">
                <i class="fas fa-heart"></i> 
                <span class="wishlist-count">0</span>
            </button>
            
            <button class="btn-submit" id="cart-btn">
                <i class="fas fa-shopping-cart"></i> 
                Cart <span class="cart-count">0</span>
            </button>
            
            <!-- Mobile Search Icon -->
            <button class="mobile-search-btn" id="mobile-search-btn">
                <i class="fas fa-search"></i>
            </button>
            
            <!-- Mobile Hamburger Menu -->
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>
    
    <!-- Cart Progress Bar -->
    <div class="filter-bar-row cart-progress-bar">
        <div class="filter-container">
            <div class="progress-step active">
                <span>1</span>
                <span class="step-label">Cart</span>
            </div>
            <div class="progress-step">
                <span>2</span>
                <span class="step-label">Shipping</span>
            </div>
            <div class="progress-step">
                <span>3</span>
                <span class="step-label">Payment</span>
            </div>
            <div class="progress-step">
                <span>4</span>
                <span class="step-label">Review</span>
            </div>
            <div class="progress-step">
                <span>5</span>
                <span class="step-label">Confirmation</span>
            </div>
        </div>
    </div>
</header>

<main class="main-content">
    <div class="cart-container">
        <!-- Cart Header -->
        <div class="cart-header">
            <h1><i class="fas fa-shopping-cart"></i> Your Shopping Cart</h1>
            <p>Review your items and proceed to checkout</p>
            
            <!-- Cart Progress -->
            <div class="cart-progress">
                <div class="progress-step completed">
                    <span>1</span>
                    <span class="step-label">Cart</span>
                </div>
                <div class="progress-step">
                    <span>2</span>
                    <span class="step-label">Shipping</span>
                </div>
                <div class="progress-step">
                    <span>3</span>
                    <span class="step-label">Payment</span>
                </div>
                <div class="progress-step">
                    <span>4</span>
                    <span class="step-label">Review</span>
                </div>
                <div class="progress-step">
                    <span>5</span>
                    <span class="step-label">Confirmation</span>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div class="cart-loading" id="cart-loading">
            <div class="loading-spinner"></div>
            <p>Loading your cart...</p>
        </div>

        <!-- Error State -->
        <div class="cart-error" id="cart-error" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Unable to Load Cart</h3>
            <p>There was an error loading your cart. Please try again.</p>
            <button class="retry-btn" id="retry-cart-btn">
                <i class="fas fa-redo"></i> Retry
            </button>
        </div>

        <!-- Empty Cart State -->
        <div class="empty-cart" id="empty-cart-state" style="display: none;">
            <div class="empty-cart-icon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <h2>Your cart is empty</h2>
            <p>Looks like you haven't added any items to your cart yet. Start shopping to discover amazing products and services!</p>
            <div class="empty-cart-actions">
                <a href="products.html" class="shop-products-btn">
                    <i class="fas fa-shopping-bag"></i> Shop Products
                </a>
                <a href="services.html" class="shop-services-btn">
                    <i class="fas fa-tools"></i> Browse Services
                </a>
            </div>
            
            <!-- Cart Suggestions -->
            <div class="cart-suggestions" id="cart-suggestions" style="display: none;">
                <h3 class="suggestions-title">
                    <i class="fas fa-lightbulb"></i> You might also like
                </h3>
                <div class="suggestions-grid" id="suggestions-grid">
                    <!-- Suggestions will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Cart with Items State -->
        <div class="cart-content" id="cart-with-items" style="display: none;">
            <!-- Cart Items Column -->
            <div class="cart-items">
                <div class="cart-items-header">
                    <h2><i class="fas fa-shopping-bag"></i> Your Items <span class="cart-items-count" id="cart-items-count">0</span></h2>
                    <button class="action-btn" id="clear-cart-btn">
                        <i class="fas fa-trash"></i> Clear Cart
                    </button>
                </div>
                <div id="cart-items-container">
                    <!-- Cart items will be dynamically generated from API -->
                </div>
            </div>

            <!-- Order Summary Column -->
            <div class="cart-summary">
                <h3 class="summary-title"><i class="fas fa-receipt"></i> Order Summary</h3>
                
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="subtotal-amount">$0.00</span>
                </div>
                
                <div class="summary-row">
                    <span>Shipping</span>
                    <span id="shipping-amount">$0.00</span>
                </div>
                
                <div class="summary-row">
                    <span>Tax</span>
                    <span id="tax-amount">$0.00</span>
                </div>
                
                <div class="summary-row highlight">
                    <span>Discount</span>
                    <span id="discount-amount">-$0.00</span>
                </div>
                
                <div class="coupon-section">
                    <div class="coupon-title">
                        <i class="fas fa-tag"></i> Have a coupon?
                    </div>
                    <div class="coupon-input-group">
                        <input type="text" class="coupon-input" id="coupon-input" placeholder="Enter coupon code">
                        <button class="apply-coupon-btn" id="apply-coupon-btn">Apply</button>
                    </div>
                    <div id="coupon-message" style="margin-top: 10px; font-size: 0.9rem; display: none;"></div>
                </div>
                
                <div class="summary-row total">
                    <span>Total</span>
                    <span id="total-amount">$0.00</span>
                </div>
                
                <div class="summary-note">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Free shipping</strong> on orders over $500. 
                        <a href="shipping.html" style="color: var(--accent-blue); text-decoration: underline; font-weight: 600;">Learn more</a>
                        <div style="margin-top: 8px; font-size: 0.85rem;">
                            <i class="fas fa-shield-alt"></i> 30-day return policy
                        </div>
                    </div>
                </div>
                
                <div class="summary-actions">
                    <button class="checkout-btn" id="checkout-btn" disabled>
                        <i class="fas fa-lock"></i> Proceed to Checkout
                    </button>
                    <button class="continue-shopping" onclick="window.location.href='products.html'">
                        <i class="fas fa-arrow-left"></i> Continue Shopping
                    </button>
                </div>
                
                <!-- Security Badges -->
                <div class="security-badges">
                    <div class="security-badge">
                        <i class="fas fa-lock"></i> Secure Checkout
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-shield-alt"></i> SSL Encrypted
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-credit-card"></i> Multiple Payments
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="main-footer">
    <div class="footer-content">
        <div class="footer-section">
            <h4>XS Platform</h4>
            <p>Your trusted source for electronics and repair services since 2024.</p>
        </div>
        
        <div class="footer-section">
            <h4>Shop</h4>
            <ul class="footer-links">
                <li><a href="products.html">All Products</a></li>
                <li><a href="products.html?category=new">New Arrivals</a></li>
                <li><a href="products.html?category=bestsellers">Best Sellers</a></li>
                <li><a href="deals.html">Deals & Discounts</a></li>
                <li><a href="services.html">Repair Services</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Customer Service</h4>
            <ul class="footer-links">
                <li><a href="contact.html">Contact Us</a></li>
                <li><a href="support.html">Support Center</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="shipping.html">Shipping Info</a></li>
                <li><a href="returns.html">Returns & Exchanges</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Account</h4>
            <ul class="footer-links">
                <li><a href="login.html">Sign In</a></li>
                <li><a href="register.html">Create Account</a></li>
                <li><a href="user-dashboard.html">My Dashboard</a></li>
                <li><a href="orders.html">Order History</a></li>
                <li><a href="wishlist.html">Wishlist</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Legal</h4>
            <ul class="footer-links">
                <li><a href="privacy-policy.html">Privacy Policy</a></li>
                <li><a href="terms.html">Terms of Service</a></li>
                <li><a href="cookies.html">Cookie Policy</a></li>
            </ul>
        </div>
    </div>
    
    <div class="copyright">
        &copy; 2024 XS Platform. All rights reserved.
    </div>
</footer>

<!-- Link to shared JavaScript file -->
<script src="header-footer.js"></script>

<!-- Cart-specific JavaScript with API Integration -->
<script>
    // API Configuration (matching products page)
    const API_BASE_URL = 'https://api.xsplatform.com'; // Replace with your actual API base URL
    const API_ENDPOINTS = {
        CART: `${API_BASE_URL}/api/v1/cart`,
        CART_ITEM: (itemId) => `${API_BASE_URL}/api/v1/cart/${itemId}`,
        PRODUCTS: `${API_BASE_URL}/api/v1/products`,
        COUPONS: `${API_BASE_URL}/api/v1/coupons`,
        WISHLIST: `${API_BASE_URL}/api/v1/wishlist`,
        USER_PROFILE: `${API_BASE_URL}/api/v1/user/profile`,
        SUGGESTIONS: `${API_BASE_URL}/api/v1/suggestions`,
        AUTH_LOGIN: `${API_BASE_URL}/api/v1/auth/login`,
        AUTH_LOGOUT: `${API_BASE_URL}/api/v1/auth/logout`
    };

    // Cart State
    let cartItems = [];
    let cartSummary = {
        subtotal: 0,
        shipping: 0,
        tax: 0,
        discount: 0,
        total: 0
    };
    let appliedCoupon = null;
    let isCartLoading = true;

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Cart page initialized with API integration');
        
        // Load cart data
        loadCart();
        
        // Initialize event listeners
        initCartEventListeners();
        
        // Update header cart count
        updateHeaderCartCount();
    });

    // API Helper Functions
    async function fetchAPI(url, options = {}) {
        try {
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${getAuthToken()}`
                },
                ...options
            };
            
            const response = await fetch(url, defaultOptions);
            
            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }
            
            return await response.json();
        } catch (error) {
            console.error('API Fetch Error:', error);
            showCartError('Failed to load cart data. Please try again.');
            throw error;
        }
    }

    function getAuthToken() {
        return localStorage.getItem('xs_auth_token') || '';
    }

    // Load cart from API
    async function loadCart() {
        try {
            showCartLoading();
            
            const data = await fetchAPI(API_ENDPOINTS.CART);
            
            cartItems = data.items || [];
            cartSummary = data.summary || calculateCartSummary(cartItems);
            
            hideCartLoading();
            renderCart();
            
            // Load suggestions if cart is empty
            if (cartItems.length === 0) {
                loadCartSuggestions();
            }
            
        } catch (error) {
            hideCartLoading();
            showCartError('Failed to load cart');
        }
    }

    // Calculate cart summary
    function calculateCartSummary(items) {
        const subtotal = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const shipping = subtotal > 500 ? 0 : 24.99;
        const tax = subtotal * 0.08; // 8% tax
        const discount = appliedCoupon ? calculateDiscount(subtotal, appliedCoupon) : 0;
        const total = subtotal + shipping + tax - discount;
        
        return {
            subtotal: parseFloat(subtotal.toFixed(2)),
            shipping: parseFloat(shipping.toFixed(2)),
            tax: parseFloat(tax.toFixed(2)),
            discount: parseFloat(discount.toFixed(2)),
            total: parseFloat(total.toFixed(2))
        };
    }

    // Calculate discount based on coupon
    function calculateDiscount(subtotal, coupon) {
        if (coupon.type === 'percentage') {
            return subtotal * (coupon.value / 100);
        } else if (coupon.type === 'fixed') {
            return coupon.value;
        }
        return 0;
    }

    // Render cart
    function renderCart() {
        const cartItemsContainer = document.getElementById('cart-items-container');
        const emptyCartState = document.getElementById('empty-cart-state');
        const cartWithItems = document.getElementById('cart-with-items');
        
        if (cartItems.length === 0) {
            cartWithItems.style.display = 'none';
            emptyCartState.style.display = 'block';
            updateHeaderCartCount(0);
            return;
        }
        
        emptyCartState.style.display = 'none';
        cartWithItems.style.display = 'grid';
        
        // Clear container
        cartItemsContainer.innerHTML = '';
        
        // Render cart items
        cartItems.forEach(item => {
            const cartItemElement = createCartItemElement(item);
            cartItemsContainer.appendChild(cartItemElement);
        });
        
        // Update cart count
        document.getElementById('cart-items-count').textContent = cartItems.length;
        
        // Update summary
        updateCartSummary();
        
        // Update header cart count
        updateHeaderCartCount(cartItems.length);
    }

    // Create cart item HTML element
    function createCartItemElement(item) {
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.dataset.itemId = item.id;
        
        const itemType = item.type || 'product';
        const typeClass = itemType === 'service' ? 'service' : 'product';
        
        // Get item image
        const itemImage = getItemImage(item);
        
        // Calculate item total
        const itemTotal = (item.price * item.quantity).toFixed(2);
        
        // Stock status
        const stockStatus = item.stock > 5 ? 'in-stock' : 
                           item.stock > 0 ? 'low-stock' : 'out-of-stock';
        const stockText = item.stock > 5 ? 'In Stock' : 
                         item.stock > 0 ? `Low Stock (${item.stock} left)` : 'Out of Stock';
        
        div.innerHTML = `
            <div class="cart-item-image">
                ${itemImage}
            </div>
            
            <div class="cart-item-details">
                <h3 class="item-title">
                    <a href="${getItemUrl(item)}">${item.name}</a>
                </h3>
                <span class="item-type ${typeClass}">
                    ${itemType.charAt(0).toUpperCase() + itemType.slice(1)}
                </span>
                
                <div class="item-meta">
                    ${item.sku ? `<div class="meta-item"><strong>SKU:</strong> ${item.sku}</div>` : ''}
                    ${item.brand ? `<div class="meta-item"><strong>Brand:</strong> ${item.brand}</div>` : ''}
                    ${item.color ? `<div class="meta-item"><strong>Color:</strong> ${item.color}</div>` : ''}
                    ${item.size ? `<div class="meta-item"><strong>Size:</strong> ${item.size}</div>` : ''}
                </div>
                
                <div class="item-price">$${item.price.toFixed(2)}</div>
                
                <div class="stock-status ${stockStatus}">${stockText}</div>
                
                <div class="item-actions">
                    <button class="action-btn save-later" data-id="${item.id}">
                        <i class="fas fa-heart"></i> Save for later
                    </button>
                    <button class="action-btn remove" data-id="${item.id}">
                        <i class="fas fa-trash"></i> Remove
                    </button>
                </div>
            </div>
            
            <div class="quantity-section">
                <div class="quantity-controls">
                    <button class="quantity-btn minus" data-id="${item.id}" ${item.quantity <= 1 ? 'disabled' : ''}>
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="text" class="quantity-input" value="${item.quantity}" 
                           data-id="${item.id}" readonly>
                    <button class="quantity-btn plus" data-id="${item.id}" 
                            ${item.quantity >= item.stock && item.stock > 0 ? 'disabled' : ''}>
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div class="item-total-section">
                    <div class="item-total">$${itemTotal}</div>
                    <div class="item-subtotal">${item.quantity} Ã— $${item.price.toFixed(2)}</div>
                </div>
            </div>
        `;
        
        return div;
    }

    // Helper function to get item image
    function getItemImage(item) {
        if (item.imageUrl) {
            return `<img src="${item.imageUrl}" alt="${item.name}" loading="lazy">`;
        }
        
        // Fallback to icons based on type
        const iconMap = {
            'phones': 'fa-mobile-alt',
            'computers': 'fa-laptop',
            'audio': 'fa-headphones',
            'electronics': 'fa-tv',
            'accessories': 'fa-keyboard',
            'tablets': 'fa-tablet-alt',
            'wearables': 'fa-clock',
            'service': 'fa-tools',
            'product': 'fa-box'
        };
        
        const type = item.type || 'product';
        const category = item.category ? item.category.toLowerCase() : type;
        const iconClass = iconMap[category] || iconMap[type] || 'fa-box';
        
        return `<i class="fas ${iconClass} placeholder-icon"></i>`;
    }

    // Helper function to get item URL
    function getItemUrl(item) {
        if (item.type === 'service') {
            return `service-detail.html?id=${item.id}`;
        }
        return `product-detail.html?id=${item.id}`;
    }

    // Update cart summary display
    function updateCartSummary() {
        cartSummary = calculateCartSummary(cartItems);
        
        document.getElementById('subtotal-amount').textContent = `$${cartSummary.subtotal.toFixed(2)}`;
        document.getElementById('shipping-amount').textContent = cartSummary.shipping === 0 ? 'FREE' : `$${cartSummary.shipping.toFixed(2)}`;
        document.getElementById('tax-amount').textContent = `$${cartSummary.tax.toFixed(2)}`;
        document.getElementById('discount-amount').textContent = `-$${cartSummary.discount.toFixed(2)}`;
        document.getElementById('total-amount').textContent = `$${cartSummary.total.toFixed(2)}`;
        
        // Update item count in summary
        document.querySelector('.summary-row:nth-child(1) span:first-child').textContent = 
            `Subtotal (${cartItems.length} item${cartItems.length !== 1 ? 's' : ''})`;
        
        // Enable/disable checkout button
        const checkoutBtn = document.getElementById('checkout-btn');
        checkoutBtn.disabled = cartItems.length === 0;
    }

    // Update header cart count
    function updateHeaderCartCount(count = null) {
        const actualCount = count !== null ? count : cartItems.length;
        
        // Update cart counts in header
        document.querySelectorAll('.cart-count, .mobile-cart-count, .nav-cart-count').forEach(el => {
            el.textContent = actualCount;
        });
        
        // Update cart button text for mobile
        const cartBtn = document.getElementById('cart-btn');
        if (cartBtn && actualCount > 0) {
            cartBtn.classList.add('has-items');
        } else if (cartBtn) {
            cartBtn.classList.remove('has-items');
        }
    }

    // Initialize event listeners
    function initCartEventListeners() {
        // Quantity button clicks (delegated)
        document.addEventListener('click', function(e) {
            const target = e.target.closest('.quantity-btn');
            if (target) {
                e.preventDefault();
                const itemId = target.dataset.id;
                const isMinus = target.classList.contains('minus');
                
                updateQuantity(itemId, isMinus ? -1 : 1);
            }
        });
        
        // Remove button clicks (delegated)
        document.addEventListener('click', function(e) {
            const target = e.target.closest('.action-btn.remove');
            if (target) {
                e.preventDefault();
                const itemId = target.dataset.id;
                removeFromCart(itemId);
            }
        });
        
        // Save for later button clicks (delegated)
        document.addEventListener('click', async function(e) {
            const target = e.target.closest('.action-btn.save-later');
            if (target) {
                e.preventDefault();
                const itemId = target.dataset.id;
                await saveForLater(itemId);
            }
        });
        
        // Clear cart button
        document.getElementById('clear-cart-btn').addEventListener('click', clearCart);
        
        // Apply coupon button
        document.getElementById('apply-coupon-btn').addEventListener('click', applyCoupon);
        
        // Checkout button
        document.getElementById('checkout-btn').addEventListener('click', proceedToCheckout);
        
        // Retry button
        document.getElementById('retry-cart-btn').addEventListener('click', loadCart);
        
        // Coupon input enter key
        document.getElementById('coupon-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                applyCoupon();
            }
        });
    }

    // Update item quantity
    async function updateQuantity(itemId, change) {
        try {
            const item = cartItems.find(item => item.id === itemId);
            if (!item) return;
            
            const newQuantity = item.quantity + change;
            
            if (newQuantity < 1) {
                removeFromCart(itemId);
                return;
            }
            
            if (newQuantity > item.stock && item.stock > 0) {
                showToast(`Only ${item.stock} items available in stock`, 'error');
                return;
            }
            
            // Update via API
            await fetchAPI(API_ENDPOINTS.CART_ITEM(itemId), {
                method: 'PUT',
                body: JSON.stringify({ quantity: newQuantity })
            });
            
            // Update local state
            item.quantity = newQuantity;
            
            // Update UI
            updateItemDisplay(itemId, newQuantity);
            updateCartSummary();
            showToast(`Quantity updated to ${newQuantity}`);
            
        } catch (error) {
            console.error('Failed to update quantity:', error);
            showToast('Failed to update quantity', 'error');
        }
    }

    // Update item display in UI
    function updateItemDisplay(itemId, quantity) {
        const itemElement = document.querySelector(`.cart-item[data-item-id="${itemId}"]`);
        if (!itemElement) return;
        
        // Update quantity input
        const quantityInput = itemElement.querySelector('.quantity-input');
        quantityInput.value = quantity;
        
        // Update minus button disabled state
        const minusBtn = itemElement.querySelector('.quantity-btn.minus');
        minusBtn.disabled = quantity <= 1;
        
        // Update plus button disabled state
        const item = cartItems.find(item => item.id === itemId);
        const plusBtn = itemElement.querySelector('.quantity-btn.plus');
        plusBtn.disabled = quantity >= item.stock && item.stock > 0;
        
        // Update total
        const itemTotal = (item.price * quantity).toFixed(2);
        itemElement.querySelector('.item-total').textContent = `$${itemTotal}`;
        itemElement.querySelector('.item-subtotal').textContent = `${quantity} Ã— $${item.price.toFixed(2)}`;
    }

    // Remove item from cart
    async function removeFromCart(itemId) {
        try {
            // Remove via API
            await fetchAPI(API_ENDPOINTS.CART_ITEM(itemId), {
                method: 'DELETE'
            });
            
            // Update local state
            cartItems = cartItems.filter(item => item.id !== itemId);
            
            // Update UI
            const itemElement = document.querySelector(`.cart-item[data-item-id="${itemId}"]`);
            if (itemElement) {
                itemElement.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => {
                    if (itemElement.parentNode) {
                        itemElement.parentNode.removeChild(itemElement);
                    }
                    renderCart();
                }, 300);
            }
            
            showToast('Item removed from cart');
            updateCartSummary();
            
        } catch (error) {
            console.error('Failed to remove item:', error);
            showToast('Failed to remove item', 'error');
        }
    }

    // Save item for later
    async function saveForLater(itemId) {
        try {
            const item = cartItems.find(item => item.id === itemId);
            if (!item) return;
            
            // Add to wishlist via API
            await fetchAPI(API_ENDPOINTS.WISHLIST, {
                method: 'POST',
                body: JSON.stringify({ productId: itemId })
            });
            
            // Remove from cart
            await removeFromCart(itemId);
            
            showToast('Item saved for later', 'success');
            
        } catch (error) {
            console.error('Failed to save for later:', error);
            showToast('Failed to save item', 'error');
        }
    }

    // Clear entire cart
    async function clearCart() {
        if (!confirm('Are you sure you want to clear your cart?')) return;
        
        try {
            // Clear cart via API
            await fetchAPI(API_ENDPOINTS.CART, {
                method: 'DELETE'
            });
            
            // Update local state
            cartItems = [];
            
            // Update UI
            renderCart();
            showToast('Cart cleared', 'success');
            
        } catch (error) {
            console.error('Failed to clear cart:', error);
            showToast('Failed to clear cart', 'error');
        }
    }

    // Apply coupon
    async function applyCoupon() {
        const couponInput = document.getElementById('coupon-input');
        const couponCode = couponInput.value.trim();
        const couponMessage = document.getElementById('coupon-message');
        
        if (!couponCode) {
            couponMessage.textContent = 'Please enter a coupon code';
            couponMessage.style.color = '#f44336';
            couponMessage.style.display = 'block';
            return;
        }
        
        try {
            // Validate coupon via API
            const response = await fetchAPI(`${API_ENDPOINTS.COUPONS}/${couponCode}`);
            
            if (response.valid) {
                appliedCoupon = response.coupon;
                couponMessage.textContent = `Coupon applied: ${response.coupon.description}`;
                couponMessage.style.color = '#4CAF50';
                couponMessage.style.display = 'block';
                
                // Update cart summary with discount
                updateCartSummary();
                showToast('Coupon applied successfully!', 'success');
                
                // Disable input and button
                couponInput.disabled = true;
                document.getElementById('apply-coupon-btn').disabled = true;
                document.getElementById('apply-coupon-btn').textContent = 'Applied';
                
            } else {
                couponMessage.textContent = response.message || 'Invalid coupon code';
                couponMessage.style.color = '#f44336';
                couponMessage.style.display = 'block';
            }
            
        } catch (error) {
            console.error('Failed to apply coupon:', error);
            couponMessage.textContent = 'Failed to apply coupon. Please try again.';
            couponMessage.style.color = '#f44336';
            couponMessage.style.display = 'block';
        }
    }

    // Proceed to checkout
    function proceedToCheckout() {
        if (cartItems.length === 0) {
            showToast('Your cart is empty', 'error');
            return;
        }
        
        // Save cart data for checkout page
        const checkoutData = {
            items: cartItems,
            summary: cartSummary,
            coupon: appliedCoupon
        };
        
        localStorage.setItem('xs_checkout_data', JSON.stringify(checkoutData));
        
        // Navigate to checkout
        window.location.href = 'checkout.html';
    }

    // Load cart suggestions for empty cart
    async function loadCartSuggestions() {
        try {
            const suggestions = await fetchAPI(API_ENDPOINTS.SUGGESTIONS);
            
            const suggestionsContainer = document.getElementById('suggestions-grid');
            const suggestionsSection = document.getElementById('cart-suggestions');
            
            if (suggestions.length > 0) {
                suggestionsSection.style.display = 'block';
                suggestionsContainer.innerHTML = suggestions.map(item => `
                    <div class="suggestion-item" data-id="${item.id}">
                        <div class="suggestion-icon">
                            <i class="fas ${getSuggestionIcon(item)}"></i>
                        </div>
                        <h4>${item.name}</h4>
                        <p>${item.description || 'Popular item'}</p>
                        <div class="item-price">$${item.price.toFixed(2)}</div>
                        <button class="add-suggestion-btn" data-id="${item.id}">
                            <i class="fas fa-cart-plus"></i> Add to Cart
                        </button>
                    </div>
                `).join('');
                
                // Add event listeners to suggestion buttons
                suggestionsContainer.querySelectorAll('.add-suggestion-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const itemId = btn.dataset.id;
                        await addSuggestionToCart(itemId);
                    });
                });
                
                // Add click listeners to suggestion items
                suggestionsContainer.querySelectorAll('.suggestion-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        if (!e.target.closest('.add-suggestion-btn')) {
                            const itemId = item.dataset.id;
                            const suggestion = suggestions.find(s => s.id === itemId);
                            if (suggestion) {
                                window.location.href = getItemUrl(suggestion);
                            }
                        }
                    });
                });
            }
            
        } catch (error) {
            console.error('Failed to load suggestions:', error);
            // Hide suggestions section if error
            document.getElementById('cart-suggestions').style.display = 'none';
        }
    }

    // Get suggestion icon
    function getSuggestionIcon(item) {
        const iconMap = {
            'phones': 'fa-mobile-alt',
            'computers': 'fa-laptop',
            'audio': 'fa-headphones',
            'electronics': 'fa-tv',
            'accessories': 'fa-keyboard',
            'tablets': 'fa-tablet-alt',
            'wearables': 'fa-clock',
            'service': 'fa-tools'
        };
        
        const category = item.category ? item.category.toLowerCase() : 'product';
        return iconMap[category] || 'fa-box';
    }

    // Add suggestion to cart
    async function addSuggestionToCart(itemId) {
        try {
            await fetchAPI(API_ENDPOINTS.CART, {
                method: 'POST',
                body: JSON.stringify({ 
                    productId: itemId,
                    quantity: 1 
                })
            });
            
            showToast('Item added to cart!', 'success');
            
            // Reload cart to show new item
            setTimeout(() => {
                loadCart();
            }, 1000);
            
        } catch (error) {
            console.error('Failed to add suggestion to cart:', error);
            showToast('Failed to add item to cart', 'error');
        }
    }

    // UI Helper Functions
    function showCartLoading() {
        isCartLoading = true;
        document.getElementById('cart-loading').style.display = 'block';
        document.getElementById('cart-error').style.display = 'none';
        document.getElementById('empty-cart-state').style.display = 'none';
        document.getElementById('cart-with-items').style.display = 'none';
    }

    function hideCartLoading() {
        isCartLoading = false;
        document.getElementById('cart-loading').style.display = 'none';
    }

    function showCartError(message) {
        document.getElementById('cart-error').style.display = 'block';
        document.getElementById('cart-error').querySelector('p').textContent = message;
        document.getElementById('cart-loading').style.display = 'none';
        document.getElementById('empty-cart-state').style.display = 'none';
        document.getElementById('cart-with-items').style.display = 'none';
    }

    function showToast(message, type = 'info') {
        // Remove existing toasts
        const existingToasts = document.querySelectorAll('.toast');
        existingToasts.forEach(toast => {
            toast.style.animation = 'slideOut 0.3s ease forwards';
            setTimeout(() => toast.remove(), 300);
        });
        
        // Create new toast
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        const icon = type === 'success' ? 'check-circle' : 
                    type === 'error' ? 'exclamation-circle' : 'info-circle';
        
        toast.innerHTML = `
            <i class="fas fa-${icon}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(toast);
        
        // Remove toast after 4 seconds
        setTimeout(() => {
            toast.style.animation = 'slideOut 0.3s ease forwards';
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }, 4000);
    }

    // Cart page API endpoints documentation
    function listCartEndpoints() {
        console.log('=== XS Platform Cart API Endpoints ===');
        console.log('Base URL:', API_BASE_URL);
        console.log('\nCart Endpoints:');
        console.log('- GET    /api/v1/cart              - Get cart contents');
        console.log('- POST   /api/v1/cart              - Add item to cart');
        console.log('- PUT    /api/v1/cart/{id}         - Update cart item quantity');
        console.log('- DELETE /api/v1/cart/{id}         - Remove item from cart');
        console.log('- DELETE /api/v1/cart              - Clear entire cart');
        
        console.log('\nCoupon Endpoints:');
        console.log('- GET    /api/v1/coupons/{code}    - Validate coupon');
        console.log('- POST   /api/v1/coupons/{code}    - Apply coupon to cart');
        
        console.log('\nSuggestion Endpoints:');
        console.log('- GET    /api/v1/suggestions       - Get cart suggestions');
        
        console.log('\nCheckout Endpoints:');
        console.log('- POST   /api/v1/checkout          - Create checkout session');
        console.log('- POST   /api/v1/orders            - Create order');
        
        console.log('\n======================================');
    }

    // Initialize and log endpoints
    listCartEndpoints();
</script>
</body>
</html>