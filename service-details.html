<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XS Platform - Service Details</title>
    <link rel="stylesheet" href="header-footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* SERVICE DETAILS PAGE SPECIFIC STYLES */
        
        /* Breadcrumb */
        .breadcrumb {
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: var(--secondary-text);
        }
        
        .breadcrumb a {
            color: var(--accent-blue);
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        /* Loading State */
        .loading-indicator {
            text-align: center;
            padding: 60px 20px;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-blue);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Error State */
        .error-message {
            background: #ffeaea;
            color: #e74c3c;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        /* Service Details Container */
        .service-details-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }
        
        @media (min-width: 992px) {
            .service-details-container {
                grid-template-columns: 2fr 1fr;
            }
        }
        
        /* Service Main Content */
        .service-main {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        /* Service Header */
        .service-header {
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .service-category {
            display: inline-block;
            padding: 6px 15px;
            background: var(--light-bg);
            color: var(--accent-blue);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .service-title {
            font-size: 2rem;
            color: var(--primary-text);
            margin: 0 0 15px;
            line-height: 1.2;
        }
        
        .service-rating {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .stars {
            color: #ffc107;
            display: flex;
            gap: 2px;
        }
        
        .rating-count {
            font-size: 0.9rem;
            color: var(--secondary-text);
        }
        
        .write-review {
            font-size: 0.9rem;
            color: var(--accent-blue);
            text-decoration: none;
            cursor: pointer;
        }
        
        .write-review:hover {
            text-decoration: underline;
        }
        
        /* Service Image */
        .service-image {
            background: var(--light-bg);
            border-radius: 12px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .service-image i {
            font-size: 100px;
            color: var(--accent-blue);
        }
        
        .service-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }
        
        /* Service Description */
        .service-description {
            line-height: 1.6;
            color: var(--primary-text);
        }
        
        .service-description h3 {
            margin-bottom: 15px;
            color: var(--primary-text);
        }
        
        .service-description p {
            margin-bottom: 20px;
        }
        
        .service-features {
            list-style: none;
            padding: 0;
            margin: 25px 0;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .service-features li {
            padding: 10px 0;
            color: var(--primary-text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .service-features li i {
            color: var(--accent-blue);
            width: 20px;
        }
        
        /* What's Included */
        .included-section {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .included-section h4 {
            color: var(--primary-text);
            margin: 0 0 15px;
        }
        
        .included-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .included-list li {
            padding: 8px 0;
            color: var(--secondary-text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .included-list li i {
            color: #2ecc71;
        }
        
        /* Repair Process */
        .repair-process {
            margin: 30px 0;
        }
        
        .process-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .process-step {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: var(--primary-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin: 0 auto 15px;
        }
        
        .step-title {
            font-weight: 600;
            color: var(--primary-text);
            margin: 0 0 10px;
        }
        
        .step-desc {
            font-size: 0.9rem;
            color: var(--secondary-text);
            margin: 0;
        }
        
        /* Service Sidebar */
        .service-sidebar {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .price-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .price-label {
            font-size: 0.9rem;
            color: var(--secondary-text);
            margin-bottom: 5px;
        }
        
        .price-amount {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin: 0 0 10px;
        }
        
        .price-note {
            font-size: 0.9rem;
            color: var(--secondary-text);
            margin: 0;
        }
        
        .duration-section {
            margin-bottom: 25px;
        }
        
        .duration-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .duration-label {
            color: var(--secondary-text);
        }
        
        .duration-value {
            font-weight: 600;
            color: var(--primary-text);
        }
        
        .warranty-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #e8f4ff;
            color: var(--primary-blue);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
        }
        
        /* Booking Form */
        .booking-form {
            margin-top: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-text);
        }
        
        .form-select, .form-input, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            color: var(--primary-text);
            background: white;
            box-sizing: border-box;
        }
        
        .form-select:focus, .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
        }
        
        .date-time-picker {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn-primary {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 16px 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: background-color 0.2s;
        }
        
        .btn-primary:hover {
            background: var(--accent-blue);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            padding: 16px 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background: var(--light-bg);
        }
        
        /* Service Meta */
        .service-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9rem;
            color: var(--secondary-text);
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Testimonials */
        .service-testimonials {
            margin-top: 50px;
        }
        
        .testimonials-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .testimonials-title {
            font-size: 1.5rem;
            color: var(--primary-text);
            margin: 0;
        }
        
        .testimonial-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .testimonial-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .testimonial-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--light-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-blue);
        }
        
        .reviewer-details h4 {
            margin: 0 0 5px;
            color: var(--primary-text);
        }
        
        .reviewer-details p {
            margin: 0;
            color: var(--secondary-text);
            font-size: 0.9rem;
        }
        
        .testimonial-content {
            color: var(--primary-text);
            line-height: 1.6;
            margin: 0;
        }
        
        /* FAQ Section */
        .faq-section {
            margin-top: 50px;
        }
        
        .faq-title {
            font-size: 1.5rem;
            color: var(--primary-text);
            margin: 0 0 30px;
        }
        
        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .faq-item {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        
        .faq-question {
            padding: 20px;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-text);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .faq-question:hover {
            background: var(--light-bg);
        }
        
        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }
        
        .faq-item.active .faq-answer {
            padding: 0 20px 20px;
            max-height: 500px;
        }
        
        .faq-item.active .faq-toggle i {
            transform: rotate(180deg);
        }
        
        .faq-toggle {
            transition: transform 0.3s ease;
        }
        
        /* Related Services */
        .related-services {
            margin-top: 50px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: var(--primary-text);
            margin: 0;
        }
        
        .section-link {
            color: var(--accent-blue);
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .section-link:hover {
            text-decoration: underline;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .service-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
        }
        
        .service-card .service-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .service-card .service-icon {
            width: 50px;
            height: 50px;
            background: var(--light-bg);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            color: var(--primary-blue);
            font-size: 20px;
        }
        
        .service-card .service-title {
            font-size: 1.2rem;
            margin: 0 0 10px;
        }
        
        .service-card .service-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-blue);
        }
        
        .service-card .service-footer {
            padding: 20px;
        }
        
        .service-card .btn-secondary {
            width: 100%;
        }
        
        /* Review Modal */
        .review-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .review-modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .review-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .review-modal-title {
            font-size: 1.5rem;
            color: var(--primary-text);
            margin: 0;
        }
        
        .review-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-text);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .service-title {
                font-size: 1.5rem;
            }
            
            .price-amount {
                font-size: 2rem;
            }
            
            .date-time-picker {
                grid-template-columns: 1fr;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .service-features {
                grid-template-columns: 1fr;
            }
            
            .process-steps {
                grid-template-columns: 1fr;
            }
            
            .review-modal-content {
                padding: 20px;
                margin: 20px;
            }
        }
    </style>
</head>
<body>
<!-- Customized Header - Same as products page -->
<header class="main-header">
    <div class="header-top-row">
        <div class="logo-and-nav">
            <div class="logo">XS</div>
            <div class="slogan">Premium Electronics Store</div>
            <nav class="main-nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="products.html" class="nav-link">Products</a>
                <a href="services.html" class="nav-link active">Services</a>
                <a href="deals.html" class="nav-link">Deals</a>
                <a href="support.html" class="nav-link">Support</a>
            </nav>
        </div>

        <div class="search-and-actions">
            <div class="search-bar-top">
                <i class="fas fa-search"></i>
                <input type="text" id="global-search" placeholder="Search products..." class="search-input">
            </div>

            <!-- Desktop Auth State -->
            <div class="auth-state">
                <!-- Logged Out State (default) -->
                <div class="logged-out-state" id="logged-out-state">
                    <a href="login.html" class="auth-link login-btn">
                        <i class="fas fa-sign-in-alt"></i> Log in
                    </a>
                </div>
                
                <!-- Logged In State -->
                <div class="logged-in-state" id="logged-in-state" style="display: none;">
                    <div class="user-profile">
                        <button class="user-menu-btn" id="user-menu-btn" aria-label="Open account menu">
                            <i class="fas fa-user-circle"></i>
                        </button>
                        <div class="user-dropdown" id="user-dropdown">
                            <a href="user-dashboard.html" class="dropdown-item">
                                <i class="fas fa-tachometer-alt"></i> Dashboard
                            </a>
                            <a href="profile.html" class="dropdown-item">
                                <i class="fas fa-user"></i> My Profile
                            </a>
                            <a href="orders.html" class="dropdown-item">
                                <i class="fas fa-box"></i> My Orders
                            </a>
                            <a href="wishlist.html" class="dropdown-item">
                                <i class="fas fa-heart"></i> Wishlist
                            </a>
                            <div class="dropdown-divider"></div>
                            <button class="dropdown-item logout-btn" id="logout-btn">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="btn-wishlist" id="wishlist-btn">
                <i class="fas fa-heart"></i> 
                <span class="wishlist-count">0</span>
            </button>
            
            <button class="btn-submit" id="cart-btn"><i class="fas fa-shopping-cart"></i> Cart <span class="cart-count">0</span></button>
            
            <!-- Mobile Search Icon -->
            <button class="mobile-search-btn" id="mobile-search-btn">
                <i class="fas fa-search"></i>
            </button>
            
            <!-- Mobile Hamburger Menu -->
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>
    
    <!-- Mobile Search Bar (Hidden by default) -->
    <div class="mobile-search-bar" id="mobile-search-bar">
        <div class="mobile-search-container">
            <input type="text" placeholder="Search..." class="mobile-search-input">
            <button class="mobile-search-close" id="mobile-search-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    
    <!-- Mobile Menu Panel (Hidden by default) -->
    <div class="mobile-menu-panel" id="mobile-menu-panel">
        <div class="mobile-menu-header">
            <div class="mobile-logo">XS</div>
            <button class="mobile-menu-close" id="mobile-menu-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mobile-menu-content">
            <!-- Mobile Auth State -->
            <div class="mobile-auth-state">
                <!-- Mobile Logged Out State -->
                <div class="mobile-logged-out-state" id="mobile-logged-out-state">
                    <a href="login.html" class="mobile-auth-link login-btn">
                        <i class="fas fa-sign-in-alt"></i> Log in
                    </a>
                </div>
                
                <!-- Mobile Logged In State -->
                <div class="mobile-logged-in-state" id="mobile-logged-in-state" style="display: none;">
                    <div class="mobile-user-info">
                        <div class="mobile-user-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="mobile-user-details">
                            <div class="mobile-user-name" id="mobile-user-name">Welcome!</div>
                            <div class="mobile-user-email" id="mobile-user-email">user@example.com</div>
                        </div>
                    </div>
                    
                    <div class="mobile-user-menu">
                        <a href="user-dashboard.html" class="mobile-nav-link">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                        <a href="profile.html" class="mobile-nav-link">
                            <i class="fas fa-user"></i> My Profile
                        </a>
                        <a href="orders.html" class="mobile-nav-link">
                            <i class="fas fa-box"></i> My Orders
                        </a>
                        <a href="wishlist.html" class="mobile-nav-link">
                            <i class="fas fa-heart"></i> Wishlist
                        </a>
                        <div class="mobile-menu-divider"></div>
                        <button class="mobile-action-btn" id="mobile-logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="mobile-nav-section">
                <a href="index.html" class="mobile-nav-link">
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="products.html" class="mobile-nav-link">
                    <i class="fas fa-shopping-bag"></i> Products
                </a>
                <a href="services.html" class="mobile-nav-link active">
                    <i class="fas fa-tools"></i> Services
                </a>
                <a href="deals.html" class="mobile-nav-link">
                    <i class="fas fa-tag"></i> Deals
                </a>
                <a href="support.html" class="mobile-nav-link">
                    <i class="fas fa-headset"></i> Support
                </a>
            </div>
            
            <div class="mobile-actions-section">
                <button class="mobile-action-btn" id="mobile-wishlist-btn">
                    <i class="fas fa-heart"></i> Wishlist <span class="mobile-wishlist-count">0</span>
                </button>
                <button class="mobile-action-btn" id="mobile-cart-btn">
                    <i class="fas fa-shopping-cart"></i> Cart <span class="mobile-cart-count">0</span>
                </button>
            </div>
        </div>
    </div>
</header>

<main class="main-content">
    <!-- Loading State -->
    <div class="loading-indicator" id="loading-indicator">
        <div class="loading-spinner"></div>
        <p>Loading service details...</p>
    </div>
    
    <!-- Error State -->
    <div class="error-message" id="error-message" style="display: none;">
        <p>Error loading service details. Please try again later.</p>
        <button class="btn-pro" id="retry-load-btn">Retry</button>
    </div>
    
    <!-- Breadcrumb -->
    <div class="breadcrumb" id="breadcrumb">
        <!-- Dynamically populated -->
    </div>
    
    <!-- Service Details Container -->
    <div class="service-details-container" id="service-details-container" style="display: none;">
        <!-- Main Content -->
        <div class="service-main">
            <!-- Service Header -->
            <div class="service-header">
                <span class="service-category" id="service-category">Loading...</span>
                <h1 class="service-title" id="service-title">Loading...</h1>
                <div class="service-rating">
                    <div class="stars" id="service-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <div class="rating-count" id="rating-count">Loading...</div>
                    <a href="#" class="write-review" id="write-review-link">Write a review</a>
                </div>
            </div>
            
            <!-- Service Image -->
            <div class="service-image" id="service-image">
                <i class="fas fa-tools"></i>
            </div>
            
            <!-- Service Description -->
            <div class="service-description">
                <h3>About This Service</h3>
                <p id="service-description">Loading...</p>
                
                <div id="service-features-container">
                    <!-- Dynamically populated -->
                </div>
                
                <!-- What's Included -->
                <div class="included-section">
                    <h4>What's Included</h4>
                    <ul class="included-list" id="included-list">
                        <!-- Dynamically populated -->
                    </ul>
                </div>
                
                <!-- Repair Process -->
                <div class="repair-process" id="repair-process-container">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>
        
        <!-- Sidebar -->
        <div class="service-sidebar">
            <!-- Price Section -->
            <div class="price-section">
                <div class="price-label">Starting from</div>
                <div class="price-amount" id="service-price">$--</div>
                <p class="price-note" id="price-note">*Final price may vary based on device model</p>
                <div class="warranty-badge" id="warranty-badge">
                    <i class="fas fa-shield-alt"></i>
                    <span id="warranty-text">Loading...</span>
                </div>
            </div>
            
            <!-- Duration Section -->
            <div class="duration-section">
                <div class="duration-item">
                    <span class="duration-label">Repair Time</span>
                    <span class="duration-value" id="repair-time">--</span>
                </div>
                <div class="duration-item">
                    <span class="duration-label">Warranty</span>
                    <span class="duration-value" id="warranty-duration">--</span>
                </div>
                <div class="duration-item">
                    <span class="duration-label">Availability</span>
                    <span class="duration-value" id="availability">--</span>
                </div>
            </div>
            
            <!-- Booking Form -->
            <div class="booking-form">
                <h3 style="margin-bottom: 20px; color: var(--primary-text);">Book This Service</h3>
                
                <div class="form-group">
                    <label class="form-label">Device Model</label>
                    <select class="form-select" id="device-model">
                        <option value="">Select your device</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Service Type</label>
                    <select class="form-select" id="service-type">
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                
                <div class="form-group date-time-picker">
                    <div>
                        <label class="form-label">Preferred Date</label>
                        <input type="date" class="form-input" id="service-date" min="">
                    </div>
                    <div>
                        <label class="form-label">Preferred Time</label>
                        <select class="form-select" id="service-time">
                            <option value="">Select time</option>
                            <!-- Time slots will be populated -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Special Instructions (Optional)</label>
                    <textarea class="form-textarea" id="instructions" rows="3" placeholder="Any specific requirements or issues..."></textarea>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn-primary" id="book-now-btn">
                    <i class="fas fa-calendar-check"></i> Book Appointment
                </button>
                <button class="btn-secondary" id="request-quote-btn-sidebar">
                    <i class="fas fa-envelope"></i> Request Quote
                </button>
            </div>
            
            <!-- Service Meta -->
            <div class="service-meta" id="service-meta">
                <!-- Dynamically populated -->
            </div>
        </div>
    </div>
    
    <!-- Testimonials -->
    <div class="service-testimonials" id="testimonials-container" style="display: none;">
        <div class="testimonials-header">
            <h2 class="testimonials-title">Customer Reviews</h2>
            <button class="btn-secondary" id="write-review-btn">
                <i class="fas fa-edit"></i> Write a Review
            </button>
        </div>
        
        <div class="testimonial-list" id="testimonial-list">
            <!-- Testimonials will be dynamically populated -->
        </div>
    </div>
    
    <!-- FAQ Section -->
    <div class="faq-section" id="faq-container" style="display: none;">
        <h2 class="faq-title">Frequently Asked Questions</h2>
        
        <div class="faq-list" id="faq-list">
            <!-- FAQ items will be dynamically populated -->
        </div>
    </div>
    
    <!-- Related Services -->
    <div class="related-services" id="related-services-container" style="display: none;">
        <div class="section-header">
            <h2 class="section-title">Related Services</h2>
            <a href="services.html" class="section-link">
                View All Services <i class="fas fa-arrow-right"></i>
            </a>
        </div>
        
        <div class="services-grid" id="related-services-grid">
            <!-- Related services will be dynamically populated -->
        </div>
    </div>
</main>

<!-- Review Modal -->
<div class="review-modal" id="review-modal">
    <div class="review-modal-content">
        <div class="review-modal-header">
            <h3 class="review-modal-title">Write a Review</h3>
            <button class="review-modal-close" id="review-modal-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form id="review-form">
            <div class="form-group">
                <label class="form-label">Rating</label>
                <div class="stars" id="review-stars" style="font-size: 24px; margin: 10px 0;">
                    <i class="far fa-star" data-rating="1"></i>
                    <i class="far fa-star" data-rating="2"></i>
                    <i class="far fa-star" data-rating="3"></i>
                    <i class="far fa-star" data-rating="4"></i>
                    <i class="far fa-star" data-rating="5"></i>
                </div>
                <input type="hidden" id="review-rating" value="0">
            </div>
            
            <div class="form-group">
                <label class="form-label">Review Title</label>
                <input type="text" class="form-input" id="review-title" placeholder="Brief summary of your experience">
            </div>
            
            <div class="form-group">
                <label class="form-label">Your Review</label>
                <textarea class="form-textarea" id="review-content" rows="5" placeholder="Share your experience with this service..."></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">Device/Service Used</label>
                <input type="text" class="form-input" id="review-device" placeholder="e.g., iPhone 14 Pro Screen Replacement">
            </div>
            
            <div class="action-buttons">
                <button type="submit" class="btn-primary">
                    <i class="fas fa-paper-plane"></i> Submit Review
                </button>
                <button type="button" class="btn-secondary" id="cancel-review-btn">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<footer class="main-footer">
    <div class="footer-content">
        <div class="footer-section">
            <h4>XS Platform</h4>
            <p>Your trusted source for electronics and repair services since 2024.</p>
        </div>
        
        <div class="footer-section">
            <h4>Shop</h4>
            <ul class="footer-links">
                <li><a href="products.html">All Products</a></li>
                <li><a href="products.html?category=new">New Arrivals</a></li>
                <li><a href="products.html?category=bestsellers">Best Sellers</a></li>
                <li><a href="deals.html">Deals & Discounts</a></li>
                <li><a href="services.html">Repair Services</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Customer Service</h4>
            <ul class="footer-links">
                <li><a href="contact.html">Contact Us</a></li>
                <li><a href="support.html">Support Center</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="shipping.html">Shipping Info</a></li>
                <li><a href="returns.html">Returns & Exchanges</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Account</h4>
            <ul class="footer-links">
                <li><a href="login.html">Sign In</a></li>
                <li><a href="register.html">Create Account</a></li>
                <li><a href="user-dashboard.html">My Dashboard</a></li>
                <li><a href="orders.html">Order History</a></li>
                <li><a href="wishlist.html">Wishlist</a></li>
            </ul>
        </div>
        
        <div class="footer-section">
            <h4>Legal</h4>
            <ul class="footer-links">
                <li><a href="privacy-policy.html">Privacy Policy</a></li>
                <li><a href="terms.html">Terms of Service</a></li>
                <li><a href="cookies.html">Cookie Policy</a></li>
            </ul>
        </div>
    </div>
    
    <div class="copyright">
        &copy; 2024 XS Platform. All rights reserved.
    </div>
</footer>

<!-- Link to shared JavaScript file -->
<script src="header-footer.js"></script>

<!-- Service details page specific JavaScript with API Integration -->
<script>
    // API Configuration
    const API_BASE_URL = 'https://api.xsplatform.com'; // Replace with your actual API base URL
    const API_ENDPOINTS = {
        SERVICES: `${API_BASE_URL}/api/v1/services`,
        SERVICE_DETAIL: `${API_BASE_URL}/api/v1/services/{id}`,
        SERVICE_REVIEWS: `${API_BASE_URL}/api/v1/services/{id}/reviews`,
        SERVICE_BOOKINGS: `${API_BASE_URL}/api/v1/service-bookings`,
        SERVICE_QUOTES: `${API_BASE_URL}/api/v1/service-quotes`,
        RELATED_SERVICES: `${API_BASE_URL}/api/v1/services/{id}/related`,
        SERVICE_FAQ: `${API_BASE_URL}/api/v1/services/{id}/faq`,
        SERVICE_AVAILABILITY: `${API_BASE_URL}/api/v1/services/{id}/availability`,
        SERVICE_DEVICES: `${API_BASE_URL}/api/v1/services/{id}/devices`,
        SERVICE_TYPES: `${API_BASE_URL}/api/v1/services/{id}/service-types`,
        CATEGORIES: `${API_BASE_URL}/api/v1/categories`,
        USER_PROFILE: `${API_BASE_URL}/api/v1/user/profile`,
        USER_SERVICE_BOOKINGS: `${API_BASE_URL}/api/v1/user/service-bookings`,
        AUTH_LOGIN: `${API_BASE_URL}/api/v1/auth/login`,
        AUTH_REGISTER: `${API_BASE_URL}/api/v1/auth/register`,
        AUTH_LOGOUT: `${API_BASE_URL}/api/v1/auth/logout`
    };

    // Current state
    let currentService = null;
    let currentServiceId = null;
    let relatedServices = [];
    let reviews = [];
    let faqs = [];
    let availableDevices = [];
    let serviceTypes = [];
    let selectedRating = 0;

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Service details page initialized with API integration');
        
        // Get service ID from URL
        currentServiceId = getServiceIdFromURL();
        
        if (currentServiceId) {
            // Load service details
            loadServiceDetails();
        } else {
            showError('Service ID not found in URL');
        }
        
        // Initialize event listeners
        initEventListeners();
        initReviewModal();
    });

    // API Helper Functions
    async function fetchAPI(url, options = {}) {
        try {
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${getAuthToken()}`
                },
                ...options
            };
            
            const response = await fetch(url, defaultOptions);
            
            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }
            
            return await response.json();
        } catch (error) {
            console.error('API Fetch Error:', error);
            throw error;
        }
    }

    function getAuthToken() {
        return localStorage.getItem('xs_auth_token') || '';
    }

    function getServiceIdFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('id') || '1'; // Default to ID 1 for demo
    }

    // Load service details from API
    async function loadServiceDetails() {
        try {
            showLoading();
            
            // Load service details
            const serviceData = await fetchAPI(API_ENDPOINTS.SERVICE_DETAIL.replace('{id}', currentServiceId));
            currentService = serviceData.service || serviceData;
            
            // Load related data
            await Promise.all([
                loadRelatedServices(),
                loadReviews(),
                loadFAQ(),
                loadAvailableDevices(),
                loadServiceTypes(),
                loadAvailability()
            ]);
            
            hideLoading();
            renderServiceDetails();
            
        } catch (error) {
            hideLoading();
            showError('Failed to load service details');
        }
    }

    // Load related services
    async function loadRelatedServices() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.RELATED_SERVICES.replace('{id}', currentServiceId));
            relatedServices = data.services || [];
        } catch (error) {
            console.error('Failed to load related services:', error);
            relatedServices = [];
        }
    }

    // Load reviews
    async function loadReviews() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.SERVICE_REVIEWS.replace('{id}', currentServiceId));
            reviews = data.reviews || [];
        } catch (error) {
            console.error('Failed to load reviews:', error);
            reviews = [];
        }
    }

    // Load FAQ
    async function loadFAQ() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.SERVICE_FAQ.replace('{id}', currentServiceId));
            faqs = data.faqs || [];
        } catch (error) {
            console.error('Failed to load FAQ:', error);
            faqs = [];
        }
    }

    // Load available devices
    async function loadAvailableDevices() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.SERVICE_DEVICES.replace('{id}', currentServiceId));
            availableDevices = data.devices || [];
        } catch (error) {
            console.error('Failed to load available devices:', error);
            availableDevices = [];
        }
    }

    // Load service types
    async function loadServiceTypes() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.SERVICE_TYPES.replace('{id}', currentServiceId));
            serviceTypes = data.serviceTypes || [];
        } catch (error) {
            console.error('Failed to load service types:', error);
            serviceTypes = [];
        }
    }

    // Load availability
    async function loadAvailability() {
        try {
            const data = await fetchAPI(API_ENDPOINTS.SERVICE_AVAILABILITY.replace('{id}', currentServiceId));
            // Process availability data
            populateTimeSlots(data.timeSlots || []);
        } catch (error) {
            console.error('Failed to load availability:', error);
        }
    }

    // Render service details
    function renderServiceDetails() {
        if (!currentService) return;
        
        // Show main container
        document.getElementById('service-details-container').style.display = 'grid';
        
        // Update breadcrumb
        renderBreadcrumb();
        
        // Update basic info
        document.getElementById('service-category').textContent = currentService.category || 'Service';
        document.getElementById('service-title').textContent = currentService.name || 'Service';
        document.getElementById('service-description').textContent = currentService.description || 'No description available';
        document.getElementById('service-price').textContent = `$${currentService.price || '--'}`;
        
        // Update rating
        updateRatingDisplay();
        
        // Update image
        renderServiceImage();
        
        // Update features
        renderServiceFeatures();
        
        // Update included list
        renderIncludedList();
        
        // Update repair process
        renderRepairProcess();
        
        // Update duration info
        updateDurationInfo();
        
        // Update warranty info
        updateWarrantyInfo();
        
        // Update meta info
        renderServiceMeta();
        
        // Populate device dropdown
        populateDeviceDropdown();
        
        // Populate service type dropdown
        populateServiceTypeDropdown();
        
        // Set minimum booking date
        setMinBookingDate();
        
        // Render testimonials
        renderTestimonials();
        
        // Render FAQ
        renderFAQ();
        
        // Render related services
        renderRelatedServices();
        
        // Show sections
        document.getElementById('testimonials-container').style.display = reviews.length > 0 ? 'block' : 'none';
        document.getElementById('faq-container').style.display = faqs.length > 0 ? 'block' : 'none';
        document.getElementById('related-services-container').style.display = relatedServices.length > 0 ? 'block' : 'none';
    }

    // Render breadcrumb
    function renderBreadcrumb() {
        const breadcrumb = document.getElementById('breadcrumb');
        breadcrumb.innerHTML = `
            <a href="index.html">Home</a> &gt;
            <a href="services.html">Services</a> &gt;
            <a href="services.html?category=${currentService.categoryId || ''}">${currentService.category || 'Category'}</a> &gt;
            <span>${currentService.name || 'Service'}</span>
        `;
    }

    // Update rating display
    function updateRatingDisplay() {
        const rating = currentService.rating || 0;
        const reviewCount = currentService.reviewCount || reviews.length;
        
        // Update stars
        const starsContainer = document.getElementById('service-stars');
        starsContainer.innerHTML = createStars(rating);
        
        // Update rating count
        document.getElementById('rating-count').textContent = `${rating.toFixed(1)} (${reviewCount} reviews)`;
    }

    // Create stars HTML
    function createStars(rating) {
        let stars = '';
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 >= 0.5;
        
        // Full stars
        for (let i = 0; i < fullStars; i++) {
            stars += '<i class="fas fa-star"></i>';
        }
        
        // Half star
        if (hasHalfStar) {
            stars += '<i class="fas fa-star-half-alt"></i>';
        }
        
        // Empty stars
        const remaining = 5 - fullStars - (hasHalfStar ? 1 : 0);
        for (let i = 0; i < remaining; i++) {
            stars += '<i class="far fa-star"></i>';
        }
        
        return stars;
    }

    // Render service image
    function renderServiceImage() {
        const imageContainer = document.getElementById('service-image');
        
        if (currentService.imageUrl) {
            imageContainer.innerHTML = `<img src="${currentService.imageUrl}" alt="${currentService.name}">`;
        } else {
            // Use icon based on category
            const iconMap = {
                'phone': 'fa-mobile-alt',
                'tablet': 'fa-tablet-alt',
                'laptop': 'fa-laptop',
                'computer': 'fa-desktop',
                'audio': 'fa-headphones',
                'camera': 'fa-camera',
                'battery': 'fa-battery-full',
                'repair': 'fa-tools'
            };
            
            const category = (currentService.category || 'repair').toLowerCase();
            const iconClass = iconMap[category] || 'fa-tools';
            
            imageContainer.innerHTML = `<i class="fas ${iconClass}"></i>`;
        }
    }

    // Render service features
    function renderServiceFeatures() {
        const container = document.getElementById('service-features-container');
        const features = currentService.features || [];
        
        if (features.length > 0) {
            let featuresHtml = '<h3>What We Fix</h3><ul class="service-features">';
            
            features.forEach(feature => {
                featuresHtml += `
                    <li><i class="fas fa-check"></i> ${feature}</li>
                `;
            });
            
            featuresHtml += '</ul>';
            container.innerHTML = featuresHtml;
        } else {
            container.innerHTML = '';
        }
    }

    // Render included list
    function renderIncludedList() {
        const container = document.getElementById('included-list');
        const included = currentService.included || [];
        
        if (included.length > 0) {
            container.innerHTML = included.map(item => `
                <li><i class="fas fa-check-circle"></i> ${item}</li>
            `).join('');
        } else {
            container.innerHTML = '<li>No information available</li>';
        }
    }

    // Render repair process
    function renderRepairProcess() {
        const container = document.getElementById('repair-process-container');
        const steps = currentService.processSteps || [];
        
        if (steps.length > 0) {
            let processHtml = '<h3>Our Repair Process</h3><div class="process-steps">';
            
            steps.forEach((step, index) => {
                processHtml += `
                    <div class="process-step">
                        <div class="step-number">${index + 1}</div>
                        <h4 class="step-title">${step.title || 'Step ' + (index + 1)}</h4>
                        <p class="step-desc">${step.description || ''}</p>
                    </div>
                `;
            });
            
            processHtml += '</div>';
            container.innerHTML = processHtml;
        } else {
            container.innerHTML = '';
        }
    }

    // Update duration info
    function updateDurationInfo() {
        document.getElementById('repair-time').textContent = currentService.repairTime || '30-60 minutes';
        document.getElementById('warranty-duration').textContent = currentService.warranty || '6 months';
        document.getElementById('availability').textContent = currentService.availability || 'Same day';
    }

    // Update warranty info
    function updateWarrantyInfo() {
        const warrantyText = document.getElementById('warranty-text');
        warrantyText.textContent = currentService.warrantyText || '6-Month Warranty Included';
    }

    // Render service meta
    function renderServiceMeta() {
        const container = document.getElementById('service-meta');
        const metaItems = currentService.meta || [];
        
        if (metaItems.length > 0) {
            container.innerHTML = metaItems.map(item => `
                <div class="meta-item">
                    <i class="fas fa-${item.icon || 'check'}"></i>
                    <span>${item.text}</span>
                </div>
            `).join('');
        } else {
            container.innerHTML = `
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>Same-day service available</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>6-month warranty</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-user-tie"></i>
                    <span>Certified technicians</span>
                </div>
            `;
        }
    }

    // Populate device dropdown
    function populateDeviceDropdown() {
        const select = document.getElementById('device-model');
        
        // Clear existing options except first
        while (select.options.length > 1) {
            select.remove(1);
        }
        
        // Add available devices
        availableDevices.forEach(device => {
            const option = document.createElement('option');
            option.value = device.id;
            option.textContent = device.name;
            select.appendChild(option);
        });
    }

    // Populate service type dropdown
    function populateServiceTypeDropdown() {
        const select = document.getElementById('service-type');
        
        // Clear existing options
        select.innerHTML = '';
        
        // Add service types
        serviceTypes.forEach(type => {
            const option = document.createElement('option');
            option.value = type.id;
            option.textContent = `${type.name} - $${type.price}`;
            if (type.isDefault) {
                option.selected = true;
            }
            select.appendChild(option);
        });
        
        // Update price when service type changes
        select.addEventListener('change', updatePriceEstimate);
        
        // Initial price update
        updatePriceEstimate();
    }

    // Populate time slots
    function populateTimeSlots(timeSlots) {
        const select = document.getElementById('service-time');
        
        // Clear existing options except first
        while (select.options.length > 1) {
            select.remove(1);
        }
        
        // Add time slots
        timeSlots.forEach(slot => {
            const option = document.createElement('option');
            option.value = slot.time;
            option.textContent = slot.displayTime;
            select.appendChild(option);
        });
    }

    // Update price estimate
    function updatePriceEstimate() {
        const serviceTypeSelect = document.getElementById('service-type');
        const deviceSelect = document.getElementById('device-model');
        const priceElement = document.getElementById('service-price');
        
        let basePrice = currentService.price || 89;
        
        // Adjust based on service type
        const selectedServiceType = serviceTypes.find(t => t.id === serviceTypeSelect.value);
        if (selectedServiceType) {
            basePrice = selectedServiceType.price;
        }
        
        // Adjust based on device (if device pricing is available)
        if (deviceSelect.value) {
            const selectedDevice = availableDevices.find(d => d.id === deviceSelect.value);
            if (selectedDevice && selectedDevice.priceAdjustment) {
                basePrice += selectedDevice.priceAdjustment;
            }
        }
        
        // Update price display
        priceElement.textContent = `$${basePrice}`;
    }

    // Set minimum booking date
    function setMinBookingDate() {
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        // Format as YYYY-MM-DD
        const minDate = tomorrow.toISOString().split('T')[0];
        const dateInput = document.getElementById('service-date');
        dateInput.min = minDate;
        dateInput.value = minDate;
    }

    // Render testimonials
    function renderTestimonials() {
        const container = document.getElementById('testimonial-list');
        
        if (reviews.length > 0) {
            container.innerHTML = reviews.map(review => `
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <div class="reviewer-info">
                            <div class="reviewer-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="reviewer-details">
                                <h4>${review.userName || 'Anonymous'}</h4>
                                <p>${review.device || 'Device not specified'}</p>
                            </div>
                        </div>
                        <div class="stars">
                            ${createStars(review.rating)}
                        </div>
                    </div>
                    <p class="testimonial-content">
                        "${review.content || 'No review content'}"
                    </p>
                </div>
            `).join('');
        } else {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-comment fa-3x" style="color: var(--border-color); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--secondary-text);">No reviews yet</h3>
                    <p style="color: var(--secondary-text);">Be the first to review this service!</p>
                </div>
            `;
        }
    }

    // Render FAQ
    function renderFAQ() {
        const container = document.getElementById('faq-list');
        
        if (faqs.length > 0) {
            container.innerHTML = faqs.map((faq, index) => `
                <div class="faq-item" id="faq-${index}">
                    <button class="faq-question">
                        ${faq.question}
                        <span class="faq-toggle">
                            <i class="fas fa-chevron-down"></i>
                        </span>
                    </button>
                    <div class="faq-answer">
                        <p>${faq.answer}</p>
                    </div>
                </div>
            `).join('');
            
            // Initialize FAQ functionality
            initFAQ();
        } else {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-question-circle fa-3x" style="color: var(--border-color); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--secondary-text);">No FAQ available</h3>
                </div>
            `;
        }
    }

    // Render related services
    function renderRelatedServices() {
        const container = document.getElementById('related-services-grid');
        
        if (relatedServices.length > 0) {
            container.innerHTML = relatedServices.slice(0, 3).map(service => `
                <div class="service-card">
                    <div class="service-header">
                        <div class="service-icon">
                            <i class="fas ${service.icon || 'fa-tools'}"></i>
                        </div>
                        <h3 class="service-title">${service.name}</h3>
                    </div>
                    <div class="service-footer">
                        <div class="service-price">$${service.price}</div>
                        <button class="btn-secondary" onclick="window.location.href='service-details.html?id=${service.id}'">
                            View Details
                        </button>
                    </div>
                </div>
            `).join('');
        }
    }

    // Initialize event listeners
    function initEventListeners() {
        // Book Now button
        document.getElementById('book-now-btn').addEventListener('click', bookService);
        
        // Request Quote button
        document.getElementById('request-quote-btn-sidebar').addEventListener('click', requestQuote);
        
        // Write review link
        document.getElementById('write-review-link').addEventListener('click', openReviewModal);
        
        // Write review button
        document.getElementById('write-review-btn').addEventListener('click', openReviewModal);
        
        // Retry button
        document.getElementById('retry-load-btn').addEventListener('click', loadServiceDetails);
        
        // Device select change
        document.getElementById('device-model').addEventListener('change', updatePriceEstimate);
    }

    // Initialize FAQ functionality
    function initFAQ() {
        const faqItems = document.querySelectorAll('.faq-item');
        
        faqItems.forEach(item => {
            const question = item.querySelector('.faq-question');
            
            question.addEventListener('click', function() {
                // Close all other FAQ items
                faqItems.forEach(otherItem => {
                    if (otherItem !== item) {
                        otherItem.classList.remove('active');
                    }
                });
                
                // Toggle current item
                item.classList.toggle('active');
            });
        });
    }

    // Initialize review modal
    function initReviewModal() {
        const modal = document.getElementById('review-modal');
        const closeBtn = document.getElementById('review-modal-close');
        const cancelBtn = document.getElementById('cancel-review-btn');
        const stars = document.querySelectorAll('#review-stars .fa-star');
        const reviewForm = document.getElementById('review-form');
        
        // Star rating selection
        stars.forEach(star => {
            star.addEventListener('click', function() {
                const rating = parseInt(this.dataset.rating);
                selectedRating = rating;
                
                // Update hidden input
                document.getElementById('review-rating').value = rating;
                
                // Update star display
                stars.forEach((s, index) => {
                    if (index < rating) {
                        s.classList.remove('far');
                        s.classList.add('fas');
                    } else {
                        s.classList.remove('fas');
                        s.classList.add('far');
                    }
                });
            });
        });
        
        // Close modal
        closeBtn.addEventListener('click', closeReviewModal);
        cancelBtn.addEventListener('click', closeReviewModal);
        
        // Submit review form
        reviewForm.addEventListener('submit', submitReview);
        
        // Close modal when clicking outside
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeReviewModal();
            }
        });
    }

    // Open review modal
    function openReviewModal(e) {
        e.preventDefault();
        
        // Check if user is logged in
        const isLoggedIn = document.getElementById('logged-in-state').style.display !== 'none';
        
        if (!isLoggedIn) {
            showMessage('Please login to write a review');
            setTimeout(() => {
                window.location.href = 'login.html?return=' + encodeURIComponent(window.location.href);
            }, 1500);
            return;
        }
        
        // Reset form
        document.getElementById('review-form').reset();
        selectedRating = 0;
        document.getElementById('review-rating').value = 0;
        
        // Reset stars
        const stars = document.querySelectorAll('#review-stars .fa-star');
        stars.forEach(star => {
            star.classList.remove('fas');
            star.classList.add('far');
        });
        
        // Show modal
        document.getElementById('review-modal').style.display = 'flex';
    }

    // Close review modal
    function closeReviewModal() {
        document.getElementById('review-modal').style.display = 'none';
    }

    // Submit review
    async function submitReview(e) {
        e.preventDefault();
        
        if (selectedRating === 0) {
            showMessage('Please select a rating');
            return;
        }
        
        const reviewData = {
            serviceId: currentServiceId,
            rating: selectedRating,
            title: document.getElementById('review-title').value,
            content: document.getElementById('review-content').value,
            device: document.getElementById('review-device').value
        };
        
        try {
            const response = await fetchAPI(API_ENDPOINTS.SERVICE_REVIEWS.replace('{id}', currentServiceId), {
                method: 'POST',
                body: JSON.stringify(reviewData)
            });
            
            showMessage('Review submitted successfully!');
            closeReviewModal();
            
            // Reload reviews
            loadReviews().then(() => {
                renderTestimonials();
                updateRatingDisplay();
            });
            
        } catch (error) {
            showMessage('Failed to submit review');
        }
    }

    // Book service
    async function bookService() {
        // Validate form
        if (!validateBookingForm()) {
            return;
        }
        
        // Check if user is logged in
        const isLoggedIn = document.getElementById('logged-in-state').style.display !== 'none';
        
        if (!isLoggedIn) {
            showMessage('Please login to book a service');
            setTimeout(() => {
                window.location.href = 'login.html?return=' + encodeURIComponent(window.location.href);
            }, 1500);
            return;
        }
        
        const bookingData = {
            serviceId: currentServiceId,
            deviceId: document.getElementById('device-model').value,
            serviceTypeId: document.getElementById('service-type').value,
            date: document.getElementById('service-date').value,
            time: document.getElementById('service-time').value,
            instructions: document.getElementById('instructions').value
        };
        
        try {
            const response = await fetchAPI(API_ENDPOINTS.SERVICE_BOOKINGS, {
                method: 'POST',
                body: JSON.stringify(bookingData)
            });
            
            showMessage('Booking confirmed! Redirecting to confirmation...');
            
            setTimeout(() => {
                window.location.href = 'booking-confirmation.html?bookingId=' + response.bookingId;
            }, 1500);
            
        } catch (error) {
            showMessage('Failed to book service. Please try again.');
        }
    }

    // Request quote
    async function requestQuote() {
        // Validate form
        if (!validateBookingForm()) {
            return;
        }
        
        const quoteData = {
            serviceId: currentServiceId,
            deviceId: document.getElementById('device-model').value,
            serviceTypeId: document.getElementById('service-type').value,
            date: document.getElementById('service-date').value,
            time: document.getElementById('service-time').value,
            instructions: document.getElementById('instructions').value,
            email: getCurrentUserEmail()
        };
        
        try {
            const response = await fetchAPI(API_ENDPOINTS.SERVICE_QUOTES, {
                method: 'POST',
                body: JSON.stringify(quoteData)
            });
            
            showMessage('Quote request submitted. We will contact you within 24 hours.');
            
            // Clear form
            setTimeout(() => {
                document.getElementById('instructions').value = '';
            }, 2000);
            
        } catch (error) {
            showMessage('Failed to submit quote request');
        }
    }

    // Validate booking form
    function validateBookingForm() {
        const deviceModel = document.getElementById('device-model');
        const serviceDate = document.getElementById('service-date');
        const serviceTime = document.getElementById('service-time');
        
        let isValid = true;
        let errorMessage = '';
        
        if (!deviceModel.value) {
            isValid = false;
            errorMessage = 'Please select your device model';
            deviceModel.focus();
        } else if (!serviceDate.value) {
            isValid = false;
            errorMessage = 'Please select a date';
            serviceDate.focus();
        } else if (!serviceTime.value) {
            isValid = false;
            errorMessage = 'Please select a time';
            serviceTime.focus();
        }
        
        if (!isValid) {
            showMessage(errorMessage);
        }
        
        return isValid;
    }

    // Get current user email
    function getCurrentUserEmail() {
        // This would typically come from user profile
        const userProfile = JSON.parse(localStorage.getItem('xs_user_profile') || '{}');
        return userProfile.email || '';
    }

    // UI Helper Functions
    function showLoading() {
        document.getElementById('loading-indicator').style.display = 'block';
        document.getElementById('error-message').style.display = 'none';
        document.getElementById('service-details-container').style.display = 'none';
    }

    function hideLoading() {
        document.getElementById('loading-indicator').style.display = 'none';
    }

    function showError(message) {
        document.getElementById('error-message').style.display = 'block';
        document.getElementById('error-message').querySelector('p').textContent = message;
        document.getElementById('loading-indicator').style.display = 'none';
    }

    function showMessage(message) {
        if (window.XSHeader && window.XSHeader.showMessage) {
            window.XSHeader.showMessage(message);
        } else {
            // Simple notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-blue);
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    }

    // API Endpoints Documentation for Services
    function listServiceAPIEndpoints() {
        console.log('=== XS Platform Service API Endpoints ===');
        console.log('Base URL:', API_BASE_URL);
        console.log('\nService Endpoints:');
        console.log('- GET  /api/v1/services              - List services with filters');
        console.log('- GET  /api/v1/services/{id}         - Get service details');
        console.log('- POST /api/v1/services              - Create new service (admin)');
        console.log('- PUT  /api/v1/services/{id}         - Update service (admin)');
        
        console.log('\nService Reviews:');
        console.log('- GET  /api/v1/services/{id}/reviews - Get service reviews');
        console.log('- POST /api/v1/services/{id}/reviews - Add service review');
        
        console.log('\nService Bookings:');
        console.log('- GET  /api/v1/service-bookings      - List bookings (user/admin)');
        console.log('- POST /api/v1/service-bookings      - Create booking');
        console.log('- GET  /api/v1/service-bookings/{id} - Get booking details');
        console.log('- PUT  /api/v1/service-bookings/{id} - Update booking status');
        
        console.log('\nService Quotes:');
        console.log('- GET  /api/v1/service-quotes        - List quotes (user/admin)');
        console.log('- POST /api/v1/service-quotes        - Request quote');
        
        console.log('\nService Metadata:');
        console.log('- GET  /api/v1/services/{id}/related - Get related services');
        console.log('- GET  /api/v1/services/{id}/faq     - Get service FAQ');
        console.log('- GET  /api/v1/services/{id}/devices - Get compatible devices');
        console.log('- GET  /api/v1/services/{id}/types   - Get service types/variants');
        console.log('- GET  /api/v1/services/{id}/availability - Check availability');
        
        console.log('\nUser Service History:');
        console.log('- GET  /api/v1/user/service-bookings - Get user bookings');
        console.log('- GET  /api/v1/user/service-quotes   - Get user quotes');
        
        console.log('\n=========================================');
    }

    // Initialize and log endpoints
    listServiceAPIEndpoints();
</script>
</body>
</html>